# --- Debug
#CONFIG_SYS_HEAP_RUNTIME_STATS=y

# --- Core
CONFIG_MAIN_STACK_SIZE=8192
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=4096
CONFIG_TIMESLICING=y
CONFIG_EVENTS=y
CONFIG_THREAD_CUSTOM_DATA=y

# --- Console / logging
CONFIG_CONSOLE_SUBSYS=y
CONFIG_CONSOLE_GETCHAR=y
CONFIG_LOG=y
CONFIG_LOG_MODE_DEFERRED=y
CONFIG_LOG_DEFAULT_LEVEL=3
CONFIG_LOG_PRINTK=y
CONFIG_LOG_BACKEND_UART=y
CONFIG_UART_INTERRUPT_DRIVEN=y

# --- Network (generic)
CONFIG_NETWORKING=y
CONFIG_NET_L2_ETHERNET=y
CONFIG_NET_SOCKETS=y
CONFIG_NET_IPV4=y
CONFIG_NET_UDP=y
CONFIG_NET_TCP=y
CONFIG_NET_DHCPV4=y
CONFIG_NET_TCP_TIME_WAIT_DELAY=250
CONFIG_DNS_RESOLVER=y

# --- Storage (generic)
CONFIG_SPI=y
CONFIG_SPI_NOR=y
CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_PARTITION_MANAGER_ENABLED=y
CONFIG_FILE_SYSTEM=y
CONFIG_FILE_SYSTEM_LITTLEFS=y
CONFIG_FILE_SYSTEM_MKFS=y
CONFIG_FS_LITTLEFS_CACHE_SIZE=128
CONFIG_FS_LITTLEFS_NUM_FILES=6
CONFIG_FS_LITTLEFS_FMP_DEV=y
CONFIG_MPU_ALLOW_FLASH_WRITE=y

# --- WiFi / WPA
CONFIG_WIFI_CREDENTIALS_STATIC=y

# --- Enable core crypto
# TLS over sockets (needed for IPPROTO_TLS_1_2) ---
CONFIG_NET_SOCKETS_SOCKOPT_TLS=n
CONFIG_MBEDTLS=y
CONFIG_MBEDTLS_ENABLE_HEAP=n
#CONFIG_MBEDTLS_HEAP_SIZE=0
CONFIG_MBEDTLS_SSL_PROTO_TLS1_2=y
# Key exchange & curves: keep only P-256 ECDHE+ECDSA
CONFIG_MBEDTLS_ECP_C=y
CONFIG_MBEDTLS_ECP_DP_SECP256R1_ENABLED=y
CONFIG_MBEDTLS_ECP_DP_SECP384R1_ENABLED=n
CONFIG_MBEDTLS_ECP_ALL_ENABLED=n
CONFIG_MBEDTLS_ECDSA_C=y
# If you don’t need RSA at all:
CONFIG_MBEDTLS_RSA_C=y
CONFIG_MBEDTLS_PKCS1_V15=y
CONFIG_MBEDTLS_PKCS1_V21=y
# Ciphers: keep AES-128-GCM only if that’s what your server supports
CONFIG_MBEDTLS_AES_C=y
CONFIG_MBEDTLS_GCM_C=y
CONFIG_MBEDTLS_CCM_C=n
# X.509 parse only (no create/CSR)
CONFIG_MBEDTLS_X509_USE_C=y
CONFIG_MBEDTLS_X509_CRT_PARSE_C=y
CONFIG_MBEDTLS_X509_CREATE_C=y
CONFIG_MBEDTLS_X509_CSR_WRITE_C=y
CONFIG_MBEDTLS_PK_PARSE_C=y
# Prefer DER; drop PEM if you can
CONFIG_MBEDTLS_PEM_PARSE_C=y
# No CRL unless you really need it
CONFIG_MBEDTLS_X509_CRL_PARSE_C=n
CONFIG_MBEDTLS_ECDH_C=y
CONFIG_MBEDTLS_SHA256_C=y
# --- Enable the ECDHE_RSA key exchange (client can then pick either ECDSA or RSA) ---
CONFIG_MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED=y
# --- Let the client send SNI (required to call mbedtls_ssl_set_hostname) ---
CONFIG_MBEDTLS_SSL_SERVER_NAME_INDICATION=y
# Allow RSA-4096 bignums
CONFIG_MBEDTLS_MPI_MAX_SIZE=512
CONFIG_MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED=y